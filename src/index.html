<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="css/settings.css" />
    <link rel="stylesheet" href="css/changelog.css" />
  </head>

  <body>
    <div class="title-bar">
      <div class="window-controls">
        <button class="window-reload-btn" id="reload-btn">
          <svg
            width="18"
            height="18"
            viewBox="-6 -6 28 28"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.16792 1.3057V0.487293C8.16792 0.104208 7.73756 -0.12216 7.39686 0.0693822L4.52778 1.75844C4.20501 1.94998 4.20501 2.40272 4.52778 2.59426L7.39686 4.28332C7.73756 4.47486 8.16792 4.24849 8.16792 3.86541V2.92511C11.037 3.09924 13.3143 5.39774 13.3143 8.23605C13.3143 9.48979 12.866 10.6913 12.0412 11.649C11.9336 11.7709 11.9515 11.945 12.0591 12.0495L12.866 12.7808C12.9916 12.8853 13.1888 12.8853 13.2964 12.7634C14.4082 11.5097 14.9999 9.9077 14.9999 8.23605C15.0178 4.50968 11.9874 1.47983 8.16792 1.3057Z"
              fill="white"
            ></path>
            <path
              d="M7.5904 12.8479C7.25027 12.6567 6.82062 12.8827 6.82062 13.2653V14.2043C3.95632 14.0304 1.68278 11.735 1.68278 8.90054C1.68278 7.64851 2.13033 6.44864 2.95381 5.49222C3.06122 5.37049 3.04332 5.1966 2.93591 5.09226L2.13033 4.36191C2.00501 4.25757 1.80809 4.25757 1.70068 4.3793C0.590763 5.63134 0 7.23116 0 8.90054C0 12.6393 3.04332 15.665 6.83852 15.8389V16.6562C6.83852 17.0388 7.26817 17.2648 7.60831 17.0736L10.4726 15.3868C10.7948 15.1955 10.7948 14.7434 10.4726 14.5521L7.5904 12.8479Z"
              fill="white"
            ></path>
          </svg>
        </button>

        <button class="window-close-btn" id="close-btn">
          <svg
            width="16"
            height="16"
            viewBox="-7 -7 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M0.928925 0.928941C1.31945 0.538416 1.95261 0.538416 2.34314 0.928941L8 6.5858L13.6569 0.928941C14.0474 0.538416 14.6806 0.538416 15.0711 0.928941C15.4616 1.31947 15.4616 1.95263 15.0711 2.34315L9.41421 8.00001L15.0711 13.6569C15.4616 14.0474 15.4616 14.6806 15.0711 15.0711C14.6805 15.4616 14.0474 15.4616 13.6568 15.0711L8 9.41423L2.34315 15.0711C1.95263 15.4616 1.31946 15.4616 0.928938 15.0711C0.538414 14.6806 0.538414 14.0474 0.928938 13.6569L6.58579 8.00001L0.928925 2.34315C0.538401 1.95263 0.538401 1.31946 0.928925 0.928941Z"
              fill="white"
            ></path>
          </svg>
        </button>
      </div>
    </div>

    <div class="LauncherContainer">
      <div class="ActionBar">
        <div class="MainIcon">
          <img
            src="./Resources/android-chrome-192x192.png"
            draggable="false"
            alt="Icon"
          />
        </div>
        <ul class="MenuItems">
          <li>
            <button id="libraryButton">
              <svg
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M15.14 10.1065C16.0078 9.29814 16.6078 8.2543 16.8628 7.10959C17.1177 5.96487 17.0159 4.77178 16.5703 3.68416C16.1248 2.59655 15.356 1.66429 14.3632 1.00763C13.3703 0.350963 12.1989 0 11 0C9.80109 0 8.62968 0.350963 7.63682 1.00763C6.64396 1.66429 5.8752 2.59655 5.42967 3.68416C4.98414 4.77178 4.88228 5.96487 5.13722 7.10959C5.39217 8.2543 5.99222 9.29814 6.86 10.1065C5.44936 10.5491 4.2188 11.4176 3.34546 12.587C2.47212 13.7565 2.00103 15.1666 2 16.6143C2 17.2559 2.12933 17.8912 2.3806 18.484C2.63188 19.0767 3.00017 19.6153 3.46447 20.069C4.40215 20.9853 5.67392 21.5 7 21.5H15C15.6566 21.5 16.3068 21.3736 16.9134 21.1281C17.52 20.8826 18.0712 20.5227 18.5355 20.069C18.9998 19.6153 19.3681 19.0767 19.6194 18.484C19.8707 17.8912 20 17.2559 20 16.6143C19.999 15.1666 19.5279 13.7565 18.6545 12.587C17.7812 11.4176 16.5506 10.5491 15.14 10.1065Z"
                />
              </svg>
            </button>
          </li>
          <li class="active">
            <button id="homeButton">
              <svg
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.5 2.75V6.75C9.5 7.47935 9.21027 8.17882 8.69454 8.69454C8.17882 9.21027 7.47935 9.5 6.75 9.5H2.75C2.02065 9.5 1.32118 9.21027 0.805456 8.69454C0.289731 8.17882 0 7.47935 0 6.75V2.75C0 2.02065 0.289731 1.32118 0.805456 0.805456C1.32118 0.289731 2.02065 0 2.75 0H6.75C7.47935 0 8.17882 0.289731 8.69454 0.805456C9.21027 1.32118 9.5 2.02065 9.5 2.75ZM18.75 0H14.75C14.0207 0 13.3212 0.289731 12.8055 0.805456C12.2897 1.32118 12 2.02065 12 2.75V6.75C12 7.47935 12.2897 8.17882 12.8055 8.69454C13.3212 9.21027 14.0207 9.5 14.75 9.5H18.75C19.4793 9.5 20.1788 9.21027 20.6945 8.69454C21.2103 8.17882 21.5 7.47935 21.5 6.75V2.75C21.5 2.02065 21.2103 1.32118 20.6945 0.805456C20.1788 0.289731 19.4793 0 18.75 0ZM18.75 12H14.75C14.0207 12 13.3212 12.2897 12.8055 12.8055C12.2897 13.3212 12 14.0207 12 14.75V18.75C12 19.4793 12.2897 20.1788 12.8055 20.6945C13.3212 21.2103 14.0207 21.5 14.75 21.5H18.75C19.4793 21.5 20.1788 21.2103 20.6945 20.6945C21.2103 20.1788 21.5 19.4793 21.5 18.75V14.75C21.5 14.0207 21.2103 13.3212 20.6945 12.8055C20.1788 12.2897 19.4793 12 18.75 12ZM6.75 12H2.75C2.02065 12 1.32118 12.2897 0.805456 12.8055C0.289731 13.3212 0 14.0207 0 14.75V18.75C0 19.4793 0.289731 20.1788 0.805456 20.6945C1.32118 21.2103 2.02065 21.5 2.75 21.5H6.75C7.47935 21.5 8.17882 21.2103 8.69454 20.6945C9.21027 20.1788 9.5 19.4793 9.5 18.75V14.75C9.5 14.0207 9.21027 13.3212 8.69454 12.8055C8.17882 12.2897 7.47935 12 6.75 12Z"
                />
              </svg>
            </button>
          </li>
          <li>
            <button id="settingsButton">
              <svg
                width="23"
                height="22"
                viewBox="0 0 23 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M22.42 9.46886C22.3581 9.02848 22.1453 8.62179 21.8164 8.31557C21.4875 8.00935 21.0621 7.8218 20.61 7.78372L19.18 7.65635L20.1 6.56885C20.3867 6.23147 20.5494 5.80954 20.5621 5.37074C20.5748 4.93193 20.4367 4.50166 20.17 4.14891C19.6212 3.44464 18.9788 2.81531 18.26 2.27761C17.9 2.01632 17.4608 1.88105 17.0129 1.89348C16.565 1.90592 16.1344 2.06534 15.79 2.3462L14.68 3.24755L14.55 1.84653C14.509 1.39628 14.3104 0.973763 13.9878 0.650574C13.6652 0.327386 13.2385 0.12341 12.78 0.0732122C11.9296 -0.0244041 11.0704 -0.0244041 10.22 0.0732122C9.77814 0.131669 9.3689 0.333104 9.05727 0.645519C8.74563 0.957935 8.54949 1.36341 8.5 1.79754L8.32 3.19856L7.21 2.29721C6.86564 2.01636 6.43499 1.85693 5.9871 1.8445C5.53922 1.83206 5.10005 1.96733 4.74 2.22863C4.02116 2.76632 3.37882 3.39565 2.83 4.09992C2.5633 4.45267 2.42523 4.88294 2.43792 5.32175C2.45062 5.76056 2.61334 6.18248 2.9 6.51986L3.82 7.60737L2.39 7.78372C1.93044 7.82387 1.49918 8.01845 1.16931 8.3345C0.839432 8.65054 0.631236 9.06861 0.58 9.51785C0.473333 10.3506 0.473333 11.1932 0.58 12.026C0.631236 12.4752 0.839432 12.8933 1.16931 13.2093C1.49918 13.5254 1.93044 13.72 2.39 13.7601L3.82 13.8875L2.9 14.926C2.61334 15.2634 2.45062 15.6853 2.43792 16.1241C2.42523 16.5629 2.5633 16.9932 2.83 17.3459C3.37882 18.0502 4.02116 18.6795 4.74 19.2172C5.10005 19.4785 5.53922 19.6138 5.9871 19.6014C6.43499 19.5889 6.86564 19.4295 7.21 19.1486L8.32 18.2473L8.5 19.6483C8.54098 20.0986 8.73959 20.5211 9.06217 20.8443C9.38475 21.1674 9.81147 21.3714 10.27 21.4216C11.12 21.5261 11.98 21.5261 12.83 21.4216C13.2885 21.3714 13.7152 21.1674 14.0378 20.8443C14.3604 20.5211 14.559 20.0986 14.6 19.6483L14.73 18.2473L15.84 19.1486C16.1844 19.4295 16.615 19.5889 17.0629 19.6014C17.5108 19.6138 17.95 19.4785 18.31 19.2172C19.0288 18.6795 19.6712 18.0502 20.22 17.3459C20.4867 16.9932 20.6248 16.5629 20.6121 16.1241C20.5994 15.6853 20.4367 15.2634 20.15 14.926L19.23 13.8385L20.66 13.7111C21.1196 13.671 21.5508 13.4764 21.8807 13.1603C22.2106 12.8443 22.4188 12.4262 22.47 11.977C22.5767 11.1442 22.5767 10.3016 22.47 9.46886H22.42ZM11.5 13.6621C10.9067 13.6621 10.3266 13.4897 9.83329 13.1668C9.33994 12.8438 8.95542 12.3848 8.72836 11.8477C8.5013 11.3106 8.44189 10.7197 8.55764 10.1495C8.6734 9.57936 8.95912 9.05565 9.37868 8.64459C9.79824 8.23354 10.3328 7.95361 10.9147 7.8402C11.4967 7.72679 12.0999 7.78499 12.6481 8.00745C13.1962 8.22992 13.6648 8.60664 13.9944 9.08999C14.3241 9.57334 14.5 10.1416 14.5 10.7229C14.5 11.5024 14.1839 12.25 13.6213 12.8013C13.0587 13.3525 12.2956 13.6621 11.5 13.6621Z"
                />
              </svg>
            </button>
          </li>
          <li>
            <button id="changelogButton">
              <svg
                width="23"
                height="22"
                viewBox="0 0 23 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.5 0C9.32441 0 7.19767 0.630476 5.38873 1.8117C3.57979 2.99293 2.16989 4.67185 1.33733 6.63615C0.504766 8.60046 0.286929 10.7619 0.711367 12.8472C1.1358 14.9325 2.18345 16.848 3.72183 18.3514C5.26021 19.8548 7.22022 20.8786 9.35401 21.2934C11.4878 21.7082 13.6995 21.4953 15.7095 20.6817C17.7195 19.8681 19.4375 18.4902 20.6462 16.7224C21.8549 14.9545 22.5 12.8761 22.5 10.75C22.5 7.89892 21.3411 5.16462 19.2782 3.1486C17.2153 1.13259 14.4174 0 11.5 0ZM11.5 17.5909C11.2033 17.5909 10.9133 17.5049 10.6666 17.3439C10.42 17.1828 10.2277 16.9538 10.1142 16.686C10.0007 16.4181 9.97095 16.1234 10.0288 15.839C10.0867 15.5547 10.2296 15.2935 10.4393 15.0884C10.6491 14.8834 10.9164 14.7438 11.2074 14.6873C11.4983 14.6307 11.7999 14.6597 12.074 14.7707C12.3481 14.8816 12.5824 15.0695 12.7472 15.3106C12.912 15.5516 13 15.8351 13 16.125C13 16.5138 12.842 16.8866 12.5607 17.1616C12.2794 17.4365 11.8978 17.5909 11.5 17.5909ZM13.23 10.2418C13.0181 10.3081 12.8331 10.4385 12.7019 10.6141C12.5707 10.7898 12.5 11.0016 12.5 11.2191V11.7273C12.5 11.9865 12.3946 12.235 12.2071 12.4183C12.0196 12.6016 11.7652 12.7045 11.5 12.7045C11.2348 12.7045 10.9804 12.6016 10.7929 12.4183C10.6054 12.235 10.5 11.9865 10.5 11.7273V11.2289C10.4999 10.6007 10.7015 9.9883 11.0765 9.47808C11.4515 8.96786 11.9808 8.58553 12.59 8.385C12.8927 8.29272 13.1513 8.09703 13.3185 7.83373C13.4857 7.57043 13.5503 7.25711 13.5005 6.95107C13.4508 6.64503 13.29 6.36672 13.0475 6.16705C12.805 5.96737 12.4971 5.85967 12.18 5.86364H10.82C10.4699 5.86364 10.1342 5.99955 9.88662 6.24147C9.63908 6.48339 9.5 6.81151 9.5 7.15363V7.81818C9.5 8.07737 9.39465 8.32594 9.20711 8.50922C9.01957 8.69249 8.76522 8.79545 8.5 8.79545C8.23479 8.79545 7.98043 8.69249 7.7929 8.50922C7.60536 8.32594 7.5 8.07737 7.5 7.81818V7.15363C7.5 6.72756 7.58588 6.30565 7.75272 5.912C7.91957 5.51836 8.16412 5.16068 8.47241 4.8594C9.09503 4.25093 9.93949 3.90909 10.82 3.90909H12.18C12.9657 3.91592 13.7237 4.19406 14.3198 4.69432C14.9159 5.19458 15.3118 5.88474 15.4375 6.64275C15.5632 7.40076 15.4106 8.17778 15.0066 8.83641C14.6026 9.49505 13.9733 9.99286 13.23 10.2418Z"
                />
              </svg>
            </button>
          </li>
        </ul>
      </div>
      <div class="RightPanel">
        <div class="LauncherInfo">
          <div id="message">Status message...</div>
          <div id="launcher-version-status-and-number">
            <span id="launcher-version-number"></span>
            <!-- This will be replaced dynamically -->
            <div id="launcher-version-status"></div>
          </div>
        </div>
        <div class="ContentArea" id="contentArea">
          <div id="game-cards-container">
            <div class="game-banner">
              <div class="card loading">
                <div class="image"></div>
                <div class="content">
                  <h1></h1>
                  <h2></h2>
                </div>
              </div>
            </div>

            <div class="game-banner">
              <div class="card loading">
                <div class="image"></div>
                <div class="content">
                  <h1></h1>
                  <h2></h2>
                </div>
              </div>
            </div>

            <div class="game-banner">
              <div class="card loading">
                <div class="image"></div>
                <div class="content">
                  <h1></h1>
                  <h2></h2>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toaster Notification -->
    <div id="toaster-container"></div>

    <script src="./js/renderer.js"></script>
    <script src="./js/settings.js"></script>
    <script src="./js/changelog.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        window.electronAPI.onNotification((data) => {
          console.log("Notification received in renderer:", data);
          createToaster(data.title, data.body, data.gameId); // Create a new toaster for each notification
        });
      });

      let toasterCount = 0;

      function createToaster(title, body, gameId) {
        toasterCount += 1;
        const toasterId = `toaster-${toasterCount}`;

        // Create toaster element
        const toaster = document.createElement("div");
        toaster.classList.add("toaster-notification", "show");
        toaster.setAttribute("id", toasterId);

        const content = `
          <div class="toaster-content">
            <div style="margin: 12px 0 12px 16px;">
              <strong>${title}</strong><br />
              <p>${body}</p>
            </div>
            <button class="toaster-button" id="toaster-download-${toasterCount}" data-game-id="${gameId}">UPDATE</button>
          </div>`;

        toaster.innerHTML = content;

        // Append toaster to the container
        document.getElementById("toaster-container").appendChild(toaster);

        // Automatically hide toaster after 10 seconds
        setTimeout(() => {
          hideToaster(toasterId);
        }, 60000);

        // Add event listener to download button
        document
          .getElementById(`toaster-download-${toasterCount}`)
          .addEventListener("click", (event) => {
            const gameId = event.target.dataset.gameId;
            window.electronAPI.downloadGame(gameId);
            hideToaster(toasterId);
          });

        updateToasterPositions();
      }
      function hideToaster(toasterId) {
        const toaster = document.getElementById(toasterId);
        if (toaster) {
          // Move the toaster to the right (off-screen)
          toaster.style.right = "-600px"; // Adjust this value if needed for smooth sliding

          // Wait for the transition to complete before removing the element
          setTimeout(() => {
            toaster.remove();
            updateToasterPositions(); // Update positions after a toaster is removed
          }, 1000); // Match the CSS transition duration
        }
      }

      function updateToasterPositions() {
        const toasters = document.querySelectorAll(".toaster-notification");
        toasters.forEach((toaster, index) => {
          const bottomOffset = 20 + index * 75; // Adjust bottom position for stacking
          toaster.style.bottom = `${bottomOffset}px`;
        });
      }
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const buttons = document.querySelectorAll(".MenuItems li button");

        console.log(buttons.length + " buttons found"); // Check if buttons are correctly selected

        buttons.forEach((button) => {
          button.addEventListener("click", function () {
            console.log("Button clicked"); // Confirm click is detected

            // Remove 'active' class from all list items
            buttons.forEach((btn) => {
              btn.parentElement.classList.remove("active");
              console.log("Active class removed"); // Check removal
            });

            // Add 'active' class to the parent 'li' of the clicked button
            this.parentElement.classList.add("active");
            console.log("Active class added to", this.id); // Check addition
          });
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const closeButton = document.getElementById("close-btn");
        closeButton.addEventListener("click", closeWindow);
      });
      document.addEventListener("DOMContentLoaded", () => {
        const closeButton = document.getElementById("reload-btn");
        closeButton.addEventListener("click", reloadWindow);
      });
    </script>
  </body>
</html>
